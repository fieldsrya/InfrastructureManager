CREATE OR REPLACE VIEW VGUEST_STATUS_VW
AS
SELECT 
  VG.VGUEST_NAME
  , VGS.POWERSTATE
  , VGS.CONFIG_STATUS
  , VC.VCLUSTER_NAME
  , VH.VHOST_NAME
  , DI.DATACENTER_NAME
FROM VMWARE_VGUEST_STATS VGS
INNER JOIN VMWARE_VGUEST VG ON VGS.VGUEST_ID = VG.VGUEST_ID
INNER JOIN VMWARE_VHOST VH ON VH.VHOST_ID = VGS.VM_VHOST_ID
INNER JOIN VMWARE_VCLUSTER VC ON VC.VCLUSTER_ID = VH.VCLUSTER_ID
INNER JOIN DATACENTER_INFO DI ON DI.DATACENTER_ID = VC.DATACENTER_ID
ORDER BY VC.VCLUSTER_ID, VH.VHOST_ID;